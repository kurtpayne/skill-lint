version: 1
name: bundled-security-signatures
patterns:
  injection:
    - id: prompt_injection_ignore
      regex: "ignore\\s+previous\\s+instructions"
      severity: high
      confidence: 0.9
      title: Prompt-injection override phrase
      remediation: Keep system instructions immutable and segment untrusted input.
    - id: prompt_injection_developer_mode
      regex: "(developer\\s+mode|jailbreak\\s+mode|DAN)"
      severity: medium
      confidence: 0.85
      title: Prompt-jailbreak marker
      remediation: Reject jailbreak tokens and apply instruction hierarchy validation.
    - id: template_raw_input
      regex: "\\{\\{\\s*user_input\\s*\\}\\}|\\{user_input\\}"
      severity: medium
      confidence: 0.8
      title: Raw user input interpolation
      remediation: Sanitize and delimit untrusted input before prompt composition.

  malware:
    - id: shell_exec
      regex: "\\b(os\\.system|subprocess\\.|eval\\(|exec\\()"
      severity: high
      confidence: 0.82
      title: Dynamic command execution
      remediation: Avoid dynamic execution paths from untrusted content.
    - id: download_exec_pipe
      regex: "\\b(curl|wget).*(\\||;).*(sh|bash|python)\\b"
      severity: critical
      confidence: 0.92
      title: Download-and-execute pipeline
      remediation: Remove one-liner execution pipelines and verify downloaded artifacts.
    - id: encoded_payload
      regex: "(base64\\s+-d|powershell\\s+-enc|FromBase64String\\()"
      severity: high
      confidence: 0.88
      title: Encoded payload execution indicator
      remediation: Review for obfuscated execution payloads.

  exfiltration:
    - id: outbound_url
      regex: "\\b(http[s]?://|webhook|pastebin|ngrok|requestbin)\\b"
      severity: medium
      confidence: 0.76
      title: Potential outbound exfiltration channel
      remediation: Enforce explicit outbound allowlist.
    - id: secret_export
      regex: "(AWS_SECRET_ACCESS_KEY|OPENAI_API_KEY|BEGIN\\s+PRIVATE\\s+KEY)"
      severity: critical
      confidence: 0.94
      title: Possible secret material exposure
      remediation: Remove secrets and rotate compromised keys immediately.

  supply_chain:
    - id: weak_pin_latest
      regex: "\\b(latest|\\*)\\b"
      severity: medium
      confidence: 0.72
      title: Weak dependency pinning
      remediation: Pin exact versions and checksums where possible.
    - id: git_head_dependency
      regex: "(git\\+https?://|github\\.com/.+@(main|master|HEAD))"
      severity: high
      confidence: 0.84
      title: Floating VCS dependency reference
      remediation: Pin immutable commit SHAs for VCS dependencies.
